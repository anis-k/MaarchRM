<div class="hide" id="importPanel">
    <div class="col-xs-12">
        <div class="row">
            <h4 class="pull-left">
                <span data-context-profil/>
                <br/>
                <small data-context-path/>
                <span data-context-parentarchive>
                    <br/>
                    <small><span>Sub-archive of</span> <b data-context-parentname/></small>
                </span>
            </h4>
        </div>
        <div class="row">
            <div class="col-lg-8 col-md-12">
                <?hinclude dashboard/mainScreen/archiveForm.html ?>
            </div>
            <div class="col-lg-4 col-md-12">
                <?hinclude dashboard/mainScreen/documentForm.html ?>    
            </div>
        </div>

        <div class="pull-right">
            <a href="#" class="btn btn-sm bg-success" id="import"><i class="fa fa-paper-plane-o">&nbsp;</i>Import</a>
            <i>&nbsp;</i>
            <a href="#" class="small text-danger" id="cancel">Cancel</a>
        </div>
    </div>
</div>

<script type="text/javascript">
    ImportPanel = {
        panel: $('#importPanel'),
        load: function(archivalProfile, orgRegNumber, folderId, parentArchive) {
            $('#archiveForm [name="originatorOrgRegNumber"]').val(orgRegNumber);
            $('#archiveForm [name="filePlanPosition"]').val(folderId);

            this.panel.removeClass('hide');

            if (!archivalProfile) {
                archivalProfile = "";
            }

            $("#archiveForm [name='archivalProfileReference']").val(archivalProfile.reference).data("json", archivalProfile).change();
            this.panel.find("[data-context-profil]:first").text(archivalProfile.name);
                
            if (parentArchive == "") {
                $("#archiveForm [name='parentArchiveId']").val('');
                this.panel.find("[data-context-parentarchive]").addClass('hide');
            }
        },

        save: function(e, button) {
            ArchiveForm.send(e, button);
        },
        cancel: function() {
            ArchiveForm.clear();
            this.panel.addClass('hide');
            trigger("showFolder.recordsManagement");
        }
    }

    $("#importPanel").onEvent('newArchiveForm.recordsManagement', function(e, archivalProfile, orgRegNumber, folderId, parentArchive) {
        ImportPanel.load(archivalProfile, orgRegNumber, folderId, parentArchive);
    });

    $('#import').on('click', function(e) {
        ImportPanel.save(e, $(this));
    });

    $('#cancel').on('click', function(e) {
        ImportPanel.cancel();
    });
</script>